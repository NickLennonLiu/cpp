### PA1a 1-6 ⑨的完美文本编辑器 解题报告

计95	刘玉河	2019011560

#### 数据结构与算法

##### 数据结构：正-反方向·双单向链表

利用两条单向链表，一条正向存放文本字符、另一条反向存放文本字符

###### 实现要点：

1. 每条链表均带头尾哨兵用于标记开头和结尾

2. 利用数组实现链表，同时建立正反链表同一字符对应的两个节点之间的联系：

    ```
    [0,MAX_LEN) 			（起始）正向链表储存空间
    [MAX_LEN, 2*MAX_LEN) 	（起始）反向链表储存空间
    nodes[i] <---> nodes[i + MAX_LEN] 
    ```

    当已知某一方向（不确定）的一个节点时，为了访问另一个方向的对应节点，只需要根据节点在数组中的位置来判断：如果小于MAX_LEN则+MAX_LEN，如果大于等于MAX_LEN则-MAX_LEN。以上逻辑通过函数int trans(int idx)实现。

3. 维护一个整型变量distance记录左右光标之间的距离

##### 左右光标：指向正向链表元素的两个指针

指定**光标指针指向某一节点**代表**光标位于该节点左侧**

###### 光标移动

- 光标右移时，只需光标指向当前节点的下一个节点

- 光标左移时，获取当前节点A在另一方向的对应节点B，取B的下一个节点C，C的另一个方向对应节点D即为A在所在单向链表中的上一个节点。

##### 文本操作：维护链表

###### 插入与删除

根据光标所在位置，增加或删除对应的节点即可，同时注意光标位置前后是否有更新，以及更新左右光标之间的距离

###### 区间翻转

- 翻转前：

正向：【pos11】->【LEFT】---------->...->【pos12】->【RIGHT】-------->...

反向：【pos21】<-【trans(LEFT)】<-...<-【pos22】<-【trans(RIGHT)】<-...

- 翻转后：

正向：【pos11】->【pos22】->...->【trans(LEFT)】->【RIGHT】

反向：【pos21】<-【pos12】<-...<-【LEFT】<-【trans(RIGHT)】

同时更新左光标LEFT的位置，因为左光标所指向的节点位于区间内。

###### 打印文本

从正向列表的头哨兵开始遍历，逐个打印节点的字符即可。

#### 遇到的问题与解决

1. 使用两个双向链表导致MLE

    起初为了方便光标的移动，为正反两个方向的链表都设计为双向链表，但由于双向链表的节点需要存放指向前后节点的指针，导致利用空间过大，超出题目允许范围

    解决途径：与王之栋、贾启珑同学交流，讨论得到利用数组进行两条单链表之间节点的联系的思路。

#### 复杂度分析

##### 时间复杂度

光标移动、插入/删除字符、区间翻转的复杂度均为$O(1)$，原因是每次操作只涉及常数个节点的创建、删除或重定向。

打印文本：遍历链表$O(n)$，n为当前文本长度

每次打印文本所用的时间，都可以$O(1)$分摊到当前文本的每一个字符上

设运行过程中涉及的字符数为n，总操作数为m，打印次数为p，则每个节点参与操作所用的时间不超过$O(m)$ 故可以给出总体时间复杂度的一个上界$O(mn)$

##### 空间复杂度

设n为初始序列长度，m为操作数

则空间复杂度为$ O(2(m+n))$